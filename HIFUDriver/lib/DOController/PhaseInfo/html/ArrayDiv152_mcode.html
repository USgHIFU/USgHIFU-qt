<pre class="code">
<span class="srcline"><span class="lineno"><a href="53,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T61U3">XDiv</span> <span class="var type1" id="S3T61U4">YDiv</span> <span class="var type1" id="S4T62U5">ZDiv</span> <span class="var type1" id="S5T62U6">DeltaS</span> <span class="var type1" id="S6T63U7">XYZVectorArrayCor</span>] = ArrayDiv(<span class="var type1" id="S7T1U10">ArrayR</span>,<span class="var type1" id="S8T1U11">RadiusNum</span>,<span class="var type1" id="S9T1U12">AngleNum</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="53,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%**************************************************************************   </span></span></span>
<span class="srcline"><span class="lineno"><a href="53,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%*  时间:2006年6月14日                                                     *   </span></span></span>
<span class="srcline"><span class="lineno"><a href="53,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%*  函数目的:将每个阵元离散化,求每个微元的的面积和XYZ坐标                     *</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%*  函数输入:ArrayR表示阵元半径                                             *</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%*  续上,RadiusNum表示半径的份数，AngleNum表示角度的份数                     *                    </span></span></span>
<span class="srcline"><span class="lineno"><a href="53,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">%*  函数输出:DeltaS表示阵元每份微元的面积                                    * </span></span></span>
<span class="srcline"><span class="lineno"><a href="53,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%*  续上, XDiv，YDiv，ZDiv分别表示阵元坐标系阵元上微元的XYZ坐标               *</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,10" id="srcline10">10</a></span><span class="line"><span class="comment">%*  XYZVectorArrayCor表示阵元坐标系中每个阵元RadiusNum*AngleNum个微元        *</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,11" id="srcline11">11</a></span><span class="line"><span class="comment">%*  续上,的XYZ坐标,矩阵中第一行代表X坐标,第二行代表Y向量,第三行代表Z向量       *</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,12" id="srcline12">12</a></span><span class="line"><span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,13" id="srcline13">13</a></span><span class="line"><span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,14" id="srcline14">14</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="53,15" id="srcline15">15</a></span><span class="line"><span class="comment">%XDiv,YDiv,ZDiv为RadiusNum*AngleNum维</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo" id="T65:U9"><span class="var type1" id="S10T65U15">RadiusDiv</span> = <span class="mxinfo" id="T65:U11"><span class="mxinfo" id="T1:U12"><span class="mxinfo" id="T1:U13"><span class="var type1" id="S7T1U20">ArrayR</span> / <span class="var type1" id="S8T1U21">RadiusNum</span></span> - <span class="mxinfo" id="T1:U16"><span class="mxinfo" id="T1:U17"><span class="var type1" id="S7T1U24">ArrayR</span> / <span class="var type1" id="S8T1U25">RadiusNum</span></span> / <span class="mxinfo" id="T1:U20">2</span></span></span> : <span class="mxinfo" id="T1:U21"><span class="var type1" id="S7T1U28">ArrayR</span> / <span class="var type1" id="S8T1U29">RadiusNum</span></span> : <span class="mxinfo" id="T1:U24"><span class="var type1" id="S7T1U31">ArrayR</span> - <span class="mxinfo" id="T1:U26"><span class="mxinfo" id="T1:U27"><span class="var type1" id="S7T1U34">ArrayR</span> / <span class="var type1" id="S8T1U35">RadiusNum</span></span> / <span class="mxinfo" id="T1:U30">2</span></span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="53,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo" id="T66:U31"><span class="var type1" id="S11T66U39">AngleDiv</span> = <span class="mxinfo" id="T66:U33"><span class="mxinfo" id="T1:U34"><span class="mxinfo" id="T1:U35">2*pi</span> / <span class="var type1" id="S9T1U47">AngleNum</span></span> : <span class="mxinfo" id="T1:U37"><span class="mxinfo" id="T1:U38">2*pi</span> / <span class="var type1" id="S9T1U53">AngleNum</span></span> : 2 * pi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="53,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo" id="T61:U40"><span class="var type1" id="S2T61U60">XDiv</span> = <span class="mxinfo" id="T61:U42"><span class="mxinfo" id="T68:U43"><span class="var type1" id="S10T65U63">RadiusDiv</span>'</span> * <span class="mxinfo" id="T66:U45">cos(<span class="var type1" id="S11T66U66">AngleDiv</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="53,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo" id="T61:U47"><span class="var type1" id="S3T61U69">YDiv</span> = <span class="mxinfo" id="T61:U49"><span class="mxinfo" id="T68:U50"><span class="var type1" id="S10T65U72">RadiusDiv</span>'</span> * <span class="mxinfo" id="T66:U52">sin(<span class="var type1" id="S11T66U75">AngleDiv</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="53,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo" id="T62:U54"><span class="var type1" id="S4T62U78">ZDiv</span> = <span class="mxinfo" id="T62:U56">zeros(<span class="var type1" id="S8T1U81">RadiusNum</span>,<span class="var type1" id="S9T1U82">AngleNum</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="53,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="53,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo" id="T62:U59"><span class="var type1" id="S5T62U85">DeltaS</span> = <span class="mxinfo" id="T62:U61">zeros(<span class="var type1" id="S8T1U88">RadiusNum</span>,<span class="var type1" id="S9T1U89">AngleNum</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="53,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo" id="T1:U64"><span class="var type1" id="S16T1U92">MTemp</span> = <span class="mxinfo" id="T1:U66">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="53,24" id="srcline24">24</a></span><span class="line"><span class="comment">%求DeltaS，一个阵元被分为RadiusNum*AngleNum个微元，DeltaS为微元的面积</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo" id="T1:U67"><span class="keyword">for</span> <span class="var type1" id="S17T1U96">AngleTemp</span> = <span class="mxinfo" id="T1:U69"><span class="mxinfo" id="T1:U70">2*pi</span> / <span class="var type1" id="S9T1U104">AngleNum</span></span> : <span class="mxinfo" id="T1:U72"><span class="mxinfo" id="T1:U73">2*pi</span>  / <span class="var type1" id="S9T1U110">AngleNum</span></span> : <span class="mxinfo" id="T1:U75">2 * pi</span>;</span>                            </span></span>
<span class="srcline"><span class="lineno"><a href="53,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo" id="T1:U67">   <span class="mxinfo" id="T1:U76"><span class="var type1" id="S16T1U117">MTemp</span> = <span class="mxinfo" id="T1:U78"><span class="var type1" id="S16T1U119">MTemp</span> + <span class="mxinfo" id="T1:U80">1</span></span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo" id="T1:U67">   <span class="mxinfo" id="T1:U81"><span class="var type1" id="S18T1U123">NTemp</span> = <span class="mxinfo" id="T1:U83">0</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo" id="T1:U67">   <span class="mxinfo" id="T1:U84"><span class="keyword">for</span> <span class="var type1" id="S19T1U127">RadiusTemp</span> = <span class="mxinfo" id="T1:U86"><span class="var type1" id="S7T1U131">ArrayR</span> / <span class="var type1" id="S8T1U132">RadiusNum</span></span> : <span class="mxinfo" id="T1:U89"><span class="var type1" id="S7T1U134">ArrayR</span> / <span class="var type1" id="S8T1U135">RadiusNum</span></span> : <span class="var type1" id="S7T1U136">ArrayR</span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="53,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo" id="T1:U67"><span class="mxinfo" id="T1:U84">      <span class="mxinfo" id="T1:U93"><span class="var type1" id="S18T1U139">NTemp</span> = <span class="mxinfo" id="T1:U95"><span class="var type1" id="S18T1U141">NTemp</span> + <span class="mxinfo" id="T1:U97">1</span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="53,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo" id="T1:U67"><span class="mxinfo" id="T1:U84">      <span class="keyword">if</span> <span class="mxinfo" id="T6:U98"><span class="var type1" id="S18T1U146">NTemp</span> == <span class="mxinfo" id="T1:U100">1</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="53,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo" id="T1:U67"><span class="mxinfo" id="T1:U84">         <span class="mxinfo" id="T1:U101"><span class="mxinfo" id="T1:U102"><span class="var type1" id="S5T62U151">DeltaS</span>(<span class="var type1" id="S18T1U152">NTemp</span>,<span class="var type1" id="S16T1U153">MTemp</span>)</span> = <span class="mxinfo" id="T1:U106"><span class="mxinfo" id="T1:U107"><span class="mxinfo" id="T1:U108"><span class="var type1" id="S19T1U157">RadiusTemp</span>.^2</span> * <span class="mxinfo" id="T1:U110">pi</span></span> / <span class="mxinfo" id="T1:U111"><span class="var type1" id="S9T1U161">AngleNum</span></span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="53,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo" id="T1:U67"><span class="mxinfo" id="T1:U84">      <span class="keyword">else</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="53,33" id="srcline33">33</a></span><span class="line"><span class="mxinfo" id="T1:U67"><span class="mxinfo" id="T1:U84">         <span class="mxinfo" id="T1:U113"><span class="mxinfo" id="T1:U114"><span class="var type1" id="S5T62U166">DeltaS</span>(<span class="var type1" id="S18T1U167">NTemp</span>,<span class="var type1" id="S16T1U168">MTemp</span>)</span>= <span class="mxinfo" id="T1:U118">(<span class="mxinfo" id="T1:U119"><span class="mxinfo" id="T1:U120"><span class="mxinfo" id="T1:U121"><span class="var type1" id="S19T1U174">RadiusTemp</span>.^2</span> * <span class="mxinfo" id="T1:U123">pi</span></span> / <span class="mxinfo" id="T1:U124"><span class="var type1" id="S9T1U178">AngleNum</span></span></span> ) - <span class="mxinfo" id="T1:U126">sum(<span class="mxinfo" id="T69:U127"><span class="var type1" id="S5T62U182">DeltaS</span>(:,<span class="var type1" id="S16T1U184">MTemp</span>)</span>)</span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="53,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo" id="T1:U67"><span class="mxinfo" id="T1:U84">      <span class="keyword">end</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="53,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo" id="T1:U67"><span class="mxinfo" id="T1:U84">   <span class="keyword">end</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="53,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo" id="T1:U67"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="53,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="53,38" id="srcline38">38</a></span><span class="line"><span class="comment">%将XDiv,YDiv,ZDiv变成行向量,有利于后续的坐标变换的批量处理</span></span></span>
<span class="srcline"><span class="lineno"><a href="53,39" id="srcline39">39</a></span><span class="line"><span class="mxinfo" id="T67:U130"><span class="var type1" id="S21T67U187">XShape</span> = <span class="mxinfo" id="T67:U132">reshape(<span class="var type1" id="S2T61U190">XDiv</span>,1,<span class="mxinfo" id="T1:U134"><span class="var type1" id="S8T1U193">RadiusNum</span>*<span class="var type1" id="S9T1U194">AngleNum</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="53,40" id="srcline40">40</a></span><span class="line"><span class="mxinfo" id="T67:U137"><span class="var type1" id="S23T67U197">YShape</span> = <span class="mxinfo" id="T67:U139">reshape(<span class="var type1" id="S3T61U200">YDiv</span>,1,<span class="mxinfo" id="T1:U141"><span class="var type1" id="S8T1U203">RadiusNum</span>*<span class="var type1" id="S9T1U204">AngleNum</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="53,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo" id="T67:U144"><span class="var type1" id="S24T67U207">ZShape</span> = <span class="mxinfo" id="T67:U146">reshape(<span class="var type1" id="S4T62U210">ZDiv</span>,1,<span class="mxinfo" id="T1:U148"><span class="var type1" id="S8T1U213">RadiusNum</span>*<span class="var type1" id="S9T1U214">AngleNum</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="53,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo" id="T63:U151"><span class="var type1" id="S6T63U217">XYZVectorArrayCor</span> = <span class="mxinfo" id="T63:U153">[<span class="var type1" id="S21T67U220">XShape</span>;<span class="var type1" id="S23T67U222">YShape</span>;<span class="var type1" id="S24T67U224">ZShape</span>]</span></span>;</span></span>
</pre>
