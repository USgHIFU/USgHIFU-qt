<pre class="code">
<span class="srcline"><span class="lineno"><a href="78,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T46U3">U</span> <span class="var type1" id="S3T47U4">AngleT</span>] = PsuedoInverse(<span class="var type1" id="S4T33U7">H</span>,<span class="var type1" id="S5T18U8">focusInfo</span>,<span class="var type1" id="S6T1U9">Rou</span>,<span class="var type1" id="S7T1U10">c</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="78,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%*  时间：2006年6月14日                                                    *</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%*  函数目的：通过特征向量法求出控制点声压向量PControl                       *</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%*  续上，算出H矩阵的伪逆HPlus，通过伪逆算法求出激励向量U                    *</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%*  函数输入：H矩阵，控制点未处理声压向量                                   *</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%*  函数输出：阵元激励向量U，控制点声压向量PControl                         *</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%*           以及近场增益G                                                *</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,12" id="srcline12"> 12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% load FocusInfo;</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,14" id="srcline14"> 14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo" id="T16:U7"><span class="var type1" id="S8T16U13">NumFocus</span> = <span class="mxinfo" id="T16:U9"><span class="var type1" id="S5T18U15">focusInfo</span>.numfocus</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo" id="T1:U11"><span class="var type1" id="S9T1U19">P</span> = <span class="mxinfo" id="T1:U13"><span class="var type1" id="S5T18U21">focusInfo</span>.p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,17" id="srcline17"> 17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,18" id="srcline18"> 18</a></span><span class="line"><span class="keyword">switch</span> <span class="var type1" id="S8T16U24">NumFocus</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,19" id="srcline19"> 19</a></span><span class="line">    <span class="keyword">case</span> <span class="mxinfo" id="T16:U16">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,20" id="srcline20"> 20</a></span><span class="line">        <span class="comment">%第二种计算相位的方法</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,21" id="srcline21"> 21</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="78,22" id="srcline22"> 22</a></span><span class="line">        <span class="mxinfo" id="T47:U17"><span class="var type1" id="S10T47U29">AngU</span> = <span class="mxinfo" id="T47:U19"><span class="mxinfo" id="T47:U20">angle(<span class="mxinfo" id="T46:U21"><span class="var type1" id="S4T33U34">H</span>'</span>)</span> + <span class="mxinfo" id="T1:U23">angle(<span class="mxinfo" id="T1:U24"><span class="var type1" id="S9T1U37">P</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,23" id="srcline23"> 23</a></span><span class="line">        <span class="mxinfo" id="T31:U26"><span class="var type1" id="S12T31U40">AmpU</span> = <span class="mxinfo" id="T31:U28"><span class="mxinfo" id="T1:U29"><span class="var type1" id="S9T1U42">P</span></span> / (<span class="mxinfo" id="T31:U31"><span class="var type1" id="S4T33U45">H</span> * <span class="mxinfo" id="T46:U33">(<span class="mxinfo" id="T33:U34"><span class="var type1" id="S4T33U49">H</span>./<span class="mxinfo" id="T60:U36">abs(<span class="var type1" id="S4T33U52">H</span>)</span></span>)'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,24" id="srcline24"> 24</a></span><span class="line">        <span class="mxinfo" id="T46:U38"><span class="var type1" id="S2T46U55">U</span> = <span class="mxinfo" id="T46:U40"><span class="var type1" id="S12T31U57">AmpU</span> * <span class="mxinfo" id="T46:U42">exp(<span class="mxinfo" id="T46:U43">1i*<span class="var type1" id="S10T47U62">AngU</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,25" id="srcline25"> 25</a></span><span class="line">    <span class="keyword">case</span> <span class="mxinfo" id="T16:U45">2</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,26" id="srcline26"> 26</a></span><span class="line">            <span class="comment">%双焦点</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,27" id="srcline27"> 27</a></span><span class="line">            <span class="mxinfo" id="T48:U46"><span class="var type1" id="S15T48U67">H11</span> = <span class="mxinfo" id="T48:U48"><span class="var type1" id="S4T33U69">H</span>(<span class="mxinfo" id="T79:U50"><span class="mxinfo" id="T1:U51">1</span>:<span class="mxinfo" id="T1:U52">10</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,28" id="srcline28"> 28</a></span><span class="line">            <span class="mxinfo" id="T49:U53"><span class="var type1" id="S16T49U75">H12</span> = <span class="mxinfo" id="T49:U55"><span class="var type1" id="S4T33U77">H</span>(<span class="mxinfo" id="T80:U57"><span class="mxinfo" id="T1:U58">21</span>:<span class="mxinfo" id="T1:U59">32</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,29" id="srcline29"> 29</a></span><span class="line">            <span class="mxinfo" id="T50:U60"><span class="var type1" id="S17T50U83">H13</span> = <span class="mxinfo" id="T50:U62"><span class="var type1" id="S4T33U85">H</span>(<span class="mxinfo" id="T81:U64"><span class="mxinfo" id="T1:U65">45</span>:<span class="mxinfo" id="T1:U66">60</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,30" id="srcline30"> 30</a></span><span class="line">            <span class="mxinfo" id="T51:U67"><span class="var type1" id="S18T51U91">H14</span> = <span class="mxinfo" id="T51:U69"><span class="var type1" id="S4T33U93">H</span>(<span class="mxinfo" id="T82:U71"><span class="mxinfo" id="T1:U72">77</span>:<span class="mxinfo" id="T1:U73">94</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,31" id="srcline31"> 31</a></span><span class="line">            <span class="mxinfo" id="T52:U74"><span class="var type1" id="S19T52U99">H1</span> = <span class="mxinfo" id="T52:U76">[<span class="var type1" id="S15T48U102">H11</span> <span class="var type1" id="S16T49U103">H12</span> <span class="var type1" id="S17T50U104">H13</span> <span class="var type1" id="S18T51U105">H14</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,32" id="srcline32"> 32</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="78,33" id="srcline33"> 33</a></span><span class="line">            <span class="mxinfo" id="T48:U81"><span class="var type1" id="S20T48U108">H21</span> = <span class="mxinfo" id="T48:U83"><span class="var type1" id="S4T33U110">H</span>(<span class="mxinfo" id="T79:U85"><span class="mxinfo" id="T1:U86">11</span>:<span class="mxinfo" id="T1:U87">20</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,34" id="srcline34"> 34</a></span><span class="line">            <span class="mxinfo" id="T49:U88"><span class="var type1" id="S21T49U116">H22</span> = <span class="mxinfo" id="T49:U90"><span class="var type1" id="S4T33U118">H</span>(<span class="mxinfo" id="T80:U92"><span class="mxinfo" id="T1:U93">33</span>:<span class="mxinfo" id="T1:U94">44</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,35" id="srcline35"> 35</a></span><span class="line">            <span class="mxinfo" id="T50:U95"><span class="var type1" id="S22T50U124">H23</span> = <span class="mxinfo" id="T50:U97"><span class="var type1" id="S4T33U126">H</span>(<span class="mxinfo" id="T81:U99"><span class="mxinfo" id="T1:U100">61</span>:<span class="mxinfo" id="T1:U101">76</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,36" id="srcline36"> 36</a></span><span class="line">            <span class="mxinfo" id="T51:U102"><span class="var type1" id="S23T51U132">H24</span> = <span class="mxinfo" id="T51:U104"><span class="var type1" id="S4T33U134">H</span>(<span class="mxinfo" id="T82:U106"><span class="mxinfo" id="T1:U107">95</span>:<span class="mxinfo" id="T1:U108">112</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,37" id="srcline37"> 37</a></span><span class="line">            <span class="mxinfo" id="T52:U109"><span class="var type1" id="S24T52U140">H2</span> = <span class="mxinfo" id="T52:U111">[<span class="var type1" id="S20T48U143">H21</span> <span class="var type1" id="S21T49U144">H22</span> <span class="var type1" id="S22T50U145">H23</span> <span class="var type1" id="S23T51U146">H24</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,38" id="srcline38"> 38</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="78,39" id="srcline39"> 39</a></span><span class="line">            <span class="mxinfo" id="T52:U116"><span class="var type1" id="S25T52U149">H_plane</span> = <span class="mxinfo" id="T52:U118"><span class="var type1" id="S19T52U151">H1</span> - <span class="var type1" id="S24T52U152">H2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,40" id="srcline40"> 40</a></span><span class="line">            <span class="mxinfo" id="T54:U121"><span class="var type1" id="S26T54U155">AngU1</span> = <span class="mxinfo" id="T54:U123"><span class="mxinfo" id="T54:U124">angle(<span class="mxinfo" id="T53:U125"><span class="var type1" id="S25T52U160">H_plane</span>'</span>)</span> + <span class="mxinfo" id="T1:U127">angle(<span class="mxinfo" id="T1:U128"><span class="var type1" id="S9T1U163">P</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,41" id="srcline41"> 41</a></span><span class="line">            <span class="mxinfo" id="T31:U130"><span class="var type1" id="S27T31U166">AmpU1</span> = <span class="mxinfo" id="T31:U132"><span class="mxinfo" id="T1:U133"><span class="var type1" id="S9T1U168">P</span></span> / (<span class="mxinfo" id="T31:U135"><span class="var type1" id="S25T52U171">H_plane</span> * <span class="mxinfo" id="T53:U137">(<span class="mxinfo" id="T52:U138"><span class="var type1" id="S25T52U175">H_plane</span>./<span class="mxinfo" id="T55:U140">abs(<span class="var type1" id="S25T52U178">H_plane</span>)</span></span>)'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,42" id="srcline42"> 42</a></span><span class="line">            <span class="mxinfo" id="T53:U142"><span class="var type1" id="S28T53U181">U1</span> = <span class="mxinfo" id="T53:U144"><span class="var type1" id="S27T31U183">AmpU1</span> * <span class="mxinfo" id="T53:U146">exp(<span class="mxinfo" id="T53:U147">1i*<span class="var type1" id="S26T54U188">AngU1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,43" id="srcline43"> 43</a></span><span class="line">            <span class="mxinfo" id="T53:U149"><span class="var type1" id="S29T53U191">U2</span> = <span class="mxinfo" id="T53:U151">-<span class="var type1" id="S28T53U193">U1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,44" id="srcline44"> 44</a></span><span class="line">            <span class="mxinfo" id="T56:U153"><span class="var type1" id="S30T56U196">U11</span> = <span class="mxinfo" id="T56:U155"><span class="var type1" id="S28T53U198">U1</span>(<span class="mxinfo" id="T79:U157"><span class="mxinfo" id="T1:U158">1</span>:<span class="mxinfo" id="T1:U159">10</span></span>)</span></span>; <span class="mxinfo" id="T57:U160"><span class="var type1" id="S31T57U204">U12</span> = <span class="mxinfo" id="T57:U162"><span class="var type1" id="S28T53U206">U1</span>(<span class="mxinfo" id="T80:U164"><span class="mxinfo" id="T1:U165">11</span>:<span class="mxinfo" id="T1:U166">22</span></span>)</span></span>; <span class="mxinfo" id="T58:U167"><span class="var type1" id="S32T58U212">U13</span> = <span class="mxinfo" id="T58:U169"><span class="var type1" id="S28T53U214">U1</span>(<span class="mxinfo" id="T81:U171"><span class="mxinfo" id="T1:U172">23</span>:<span class="mxinfo" id="T1:U173">38</span></span>)</span></span>; <span class="mxinfo" id="T59:U174"><span class="var type1" id="S33T59U220">U14</span> = <span class="mxinfo" id="T59:U176"><span class="var type1" id="S28T53U222">U1</span>(<span class="mxinfo" id="T82:U178"><span class="mxinfo" id="T1:U179">39</span>:<span class="mxinfo" id="T1:U180">56</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,45" id="srcline45"> 45</a></span><span class="line">            <span class="mxinfo" id="T56:U181"><span class="var type1" id="S34T56U228">U21</span> = <span class="mxinfo" id="T56:U183"><span class="var type1" id="S29T53U230">U2</span>(<span class="mxinfo" id="T79:U185"><span class="mxinfo" id="T1:U186">1</span>:<span class="mxinfo" id="T1:U187">10</span></span>)</span></span>; <span class="mxinfo" id="T57:U188"><span class="var type1" id="S35T57U236">U22</span> = <span class="mxinfo" id="T57:U190"><span class="var type1" id="S29T53U238">U2</span>(<span class="mxinfo" id="T80:U192"><span class="mxinfo" id="T1:U193">11</span>:<span class="mxinfo" id="T1:U194">22</span></span>)</span></span>; <span class="mxinfo" id="T58:U195"><span class="var type1" id="S36T58U244">U23</span> = <span class="mxinfo" id="T58:U197"><span class="var type1" id="S29T53U246">U2</span>(<span class="mxinfo" id="T81:U199"><span class="mxinfo" id="T1:U200">23</span>:<span class="mxinfo" id="T1:U201">38</span></span>)</span></span>; <span class="mxinfo" id="T59:U202"><span class="var type1" id="S37T59U252">U24</span> = <span class="mxinfo" id="T59:U204"><span class="var type1" id="S29T53U254">U2</span>(<span class="mxinfo" id="T82:U206"><span class="mxinfo" id="T1:U207">39</span>:<span class="mxinfo" id="T1:U208">56</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,46" id="srcline46"> 46</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="78,47" id="srcline47"> 47</a></span><span class="line">            <span class="mxinfo" id="T46:U209"><span class="var type1" id="S2T46U260">U</span> = <span class="mxinfo" id="T46:U211">[<span class="var type1" id="S30T56U263">U11</span>;<span class="var type1" id="S34T56U265">U21</span>;<span class="var type1" id="S31T57U267">U12</span>;<span class="var type1" id="S35T57U269">U22</span>;<span class="var type1" id="S32T58U271">U13</span>;<span class="var type1" id="S36T58U273">U23</span>;<span class="var type1" id="S33T59U275">U14</span>;<span class="var type1" id="S37T59U277">U24</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,48" id="srcline48"> 48</a></span><span class="line">            <span class="mxinfo" id="T47:U220"><span class="var type1" id="S12T47U280">AmpU</span> = <span class="mxinfo" id="T47:U222">abs(<span class="var type1" id="S2T46U283">U</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,49" id="srcline49"> 49</a></span><span class="line">            <span class="mxinfo" id="T47:U224"><span class="var type1" id="S10T47U286">AngU</span> = <span class="mxinfo" id="T47:U226">angle(<span class="var type1" id="S2T46U289">U</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,50" id="srcline50"> 50</a></span><span class="line">         <span class="keyword">case</span> <span class="mxinfo" id="T16:U228">4</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,51" id="srcline51"> 51</a></span><span class="line">                <span class="comment">%四焦点</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,52" id="srcline52"> 52</a></span><span class="line">                <span class="mxinfo" id="T34:U229"><span class="var type1" id="S15T34U294">H11</span> = <span class="mxinfo" id="T34:U231"><span class="var type1" id="S4T33U296">H</span>(<span class="mxinfo" id="T83:U233"><span class="mxinfo" id="T1:U234">1</span>:<span class="mxinfo" id="T1:U235">5</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,53" id="srcline53"> 53</a></span><span class="line">                <span class="mxinfo" id="T35:U236"><span class="var type1" id="S16T35U302">H12</span> = <span class="mxinfo" id="T35:U238"><span class="var type1" id="S4T33U304">H</span>(<span class="mxinfo" id="T84:U240"><span class="mxinfo" id="T1:U241">21</span>:<span class="mxinfo" id="T1:U242">26</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,54" id="srcline54"> 54</a></span><span class="line">                <span class="mxinfo" id="T36:U243"><span class="var type1" id="S17T36U310">H13</span> = <span class="mxinfo" id="T36:U245"><span class="var type1" id="S4T33U312">H</span>(<span class="mxinfo" id="T85:U247"><span class="mxinfo" id="T1:U248">45</span>:<span class="mxinfo" id="T1:U249">52</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,55" id="srcline55"> 55</a></span><span class="line">                <span class="mxinfo" id="T37:U250"><span class="var type1" id="S18T37U318">H14</span> = <span class="mxinfo" id="T37:U252"><span class="var type1" id="S4T33U320">H</span>(<span class="mxinfo" id="T86:U254"><span class="mxinfo" id="T1:U255">77</span>:<span class="mxinfo" id="T1:U256">85</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,56" id="srcline56"> 56</a></span><span class="line">                <span class="mxinfo" id="T38:U257"><span class="var type1" id="S19T38U326">H1</span> = <span class="mxinfo" id="T38:U259">[<span class="var type1" id="S15T34U329">H11</span> <span class="var type1" id="S16T35U330">H12</span> <span class="var type1" id="S17T36U331">H13</span> <span class="var type1" id="S18T37U332">H14</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,57" id="srcline57"> 57</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="78,58" id="srcline58"> 58</a></span><span class="line">                <span class="mxinfo" id="T34:U264"><span class="var type1" id="S20T34U335">H21</span> = <span class="mxinfo" id="T34:U266">fliplr(<span class="mxinfo" id="T34:U267"><span class="var type1" id="S4T33U339">H</span>(<span class="mxinfo" id="T83:U269"><span class="mxinfo" id="T1:U270">6</span>:<span class="mxinfo" id="T1:U271">10</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,59" id="srcline59"> 59</a></span><span class="line">                <span class="mxinfo" id="T35:U272"><span class="var type1" id="S21T35U345">H22</span> = <span class="mxinfo" id="T35:U274">fliplr(<span class="mxinfo" id="T35:U275"><span class="var type1" id="S4T33U349">H</span>(<span class="mxinfo" id="T84:U277"><span class="mxinfo" id="T1:U278">27</span>:<span class="mxinfo" id="T1:U279">32</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,60" id="srcline60"> 60</a></span><span class="line">                <span class="mxinfo" id="T36:U280"><span class="var type1" id="S22T36U355">H23</span> = <span class="mxinfo" id="T36:U282">fliplr(<span class="mxinfo" id="T36:U283"><span class="var type1" id="S4T33U359">H</span>(<span class="mxinfo" id="T85:U285"><span class="mxinfo" id="T1:U286">53</span>:<span class="mxinfo" id="T1:U287">60</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,61" id="srcline61"> 61</a></span><span class="line">                <span class="mxinfo" id="T37:U288"><span class="var type1" id="S23T37U365">H24</span> = <span class="mxinfo" id="T37:U290">fliplr(<span class="mxinfo" id="T37:U291"><span class="var type1" id="S4T33U369">H</span>(<span class="mxinfo" id="T86:U293"><span class="mxinfo" id="T1:U294">86</span>:<span class="mxinfo" id="T1:U295">94</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,62" id="srcline62"> 62</a></span><span class="line">                <span class="mxinfo" id="T38:U296"><span class="var type1" id="S24T38U375">H2</span> = <span class="mxinfo" id="T38:U298">[<span class="var type1" id="S20T34U378">H21</span> <span class="var type1" id="S21T35U379">H22</span> <span class="var type1" id="S22T36U380">H23</span> <span class="var type1" id="S23T37U381">H24</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,63" id="srcline63"> 63</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="78,64" id="srcline64"> 64</a></span><span class="line">                <span class="mxinfo" id="T34:U303"><span class="var type1" id="S39T34U384">H31</span> = <span class="mxinfo" id="T34:U305"><span class="var type1" id="S4T33U386">H</span>(<span class="mxinfo" id="T83:U307"><span class="mxinfo" id="T1:U308">11</span>:<span class="mxinfo" id="T1:U309">15</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,65" id="srcline65"> 65</a></span><span class="line">                <span class="mxinfo" id="T35:U310"><span class="var type1" id="S40T35U392">H32</span> = <span class="mxinfo" id="T35:U312"><span class="var type1" id="S4T33U394">H</span>(<span class="mxinfo" id="T84:U314"><span class="mxinfo" id="T1:U315">33</span>:<span class="mxinfo" id="T1:U316">38</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,66" id="srcline66"> 66</a></span><span class="line">                <span class="mxinfo" id="T36:U317"><span class="var type1" id="S41T36U400">H33</span> = <span class="mxinfo" id="T36:U319"><span class="var type1" id="S4T33U402">H</span>(<span class="mxinfo" id="T85:U321"><span class="mxinfo" id="T1:U322">61</span>:<span class="mxinfo" id="T1:U323">68</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,67" id="srcline67"> 67</a></span><span class="line">                <span class="mxinfo" id="T37:U324"><span class="var type1" id="S42T37U408">H34</span> = <span class="mxinfo" id="T37:U326"><span class="var type1" id="S4T33U410">H</span>(<span class="mxinfo" id="T86:U328"><span class="mxinfo" id="T1:U329">95</span>:<span class="mxinfo" id="T1:U330">103</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,68" id="srcline68"> 68</a></span><span class="line">                <span class="mxinfo" id="T38:U331"><span class="var type1" id="S43T38U416">H3</span> = <span class="mxinfo" id="T38:U333">[<span class="var type1" id="S39T34U419">H31</span> <span class="var type1" id="S40T35U420">H32</span> <span class="var type1" id="S41T36U421">H33</span> <span class="var type1" id="S42T37U422">H34</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,69" id="srcline69"> 69</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="78,70" id="srcline70"> 70</a></span><span class="line">                <span class="mxinfo" id="T34:U338"><span class="var type1" id="S44T34U425">H41</span> = <span class="mxinfo" id="T34:U340">fliplr(<span class="mxinfo" id="T34:U341"><span class="var type1" id="S4T33U429">H</span>(<span class="mxinfo" id="T83:U343"><span class="mxinfo" id="T1:U344">16</span>:<span class="mxinfo" id="T1:U345">20</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,71" id="srcline71"> 71</a></span><span class="line">                <span class="mxinfo" id="T35:U346"><span class="var type1" id="S45T35U435">H42</span> = <span class="mxinfo" id="T35:U348">fliplr(<span class="mxinfo" id="T35:U349"><span class="var type1" id="S4T33U439">H</span>(<span class="mxinfo" id="T84:U351"><span class="mxinfo" id="T1:U352">39</span>:<span class="mxinfo" id="T1:U353">44</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,72" id="srcline72"> 72</a></span><span class="line">                <span class="mxinfo" id="T36:U354"><span class="var type1" id="S46T36U445">H43</span> = <span class="mxinfo" id="T36:U356">fliplr(<span class="mxinfo" id="T36:U357"><span class="var type1" id="S4T33U449">H</span>(<span class="mxinfo" id="T85:U359"><span class="mxinfo" id="T1:U360">69</span>:<span class="mxinfo" id="T1:U361">76</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,73" id="srcline73"> 73</a></span><span class="line">                <span class="mxinfo" id="T37:U362"><span class="var type1" id="S47T37U455">H44</span> = <span class="mxinfo" id="T37:U364">fliplr(<span class="mxinfo" id="T37:U365"><span class="var type1" id="S4T33U459">H</span>(<span class="mxinfo" id="T86:U367"><span class="mxinfo" id="T1:U368">104</span>:<span class="mxinfo" id="T1:U369">112</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,74" id="srcline74"> 74</a></span><span class="line">                <span class="mxinfo" id="T38:U370"><span class="var type1" id="S48T38U465">H4</span> = <span class="mxinfo" id="T38:U372">[<span class="var type1" id="S44T34U468">H41</span> <span class="var type1" id="S45T35U469">H42</span> <span class="var type1" id="S46T36U470">H43</span> <span class="var type1" id="S47T37U471">H44</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,75" id="srcline75"> 75</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="78,76" id="srcline76"> 76</a></span><span class="line">                <span class="mxinfo" id="T38:U377"><span class="var type1" id="S25T38U474">H_plane</span> = <span class="mxinfo" id="T38:U379"><span class="mxinfo" id="T38:U380"><span class="mxinfo" id="T38:U381"><span class="var type1" id="S19T38U478">H1</span> - <span class="var type1" id="S24T38U479">H2</span></span> + <span class="var type1" id="S43T38U480">H3</span></span> - <span class="var type1" id="S48T38U481">H4</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,77" id="srcline77"> 77</a></span><span class="line">                <span class="mxinfo" id="T40:U386"><span class="var type1" id="S26T40U484">AngU1</span> = <span class="mxinfo" id="T40:U388"><span class="mxinfo" id="T40:U389">angle(<span class="mxinfo" id="T39:U390"><span class="var type1" id="S25T38U489">H_plane</span>'</span>)</span> + <span class="mxinfo" id="T1:U392">angle(<span class="mxinfo" id="T1:U393"><span class="var type1" id="S9T1U492">P</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,78" id="srcline78"> 78</a></span><span class="line">                <span class="mxinfo" id="T31:U395"><span class="var type1" id="S27T31U495">AmpU1</span> = <span class="mxinfo" id="T31:U397"><span class="mxinfo" id="T1:U398"><span class="var type1" id="S9T1U497">P</span></span> / (<span class="mxinfo" id="T31:U400"><span class="var type1" id="S25T38U500">H_plane</span> * <span class="mxinfo" id="T39:U402">(<span class="mxinfo" id="T38:U403"><span class="var type1" id="S25T38U504">H_plane</span>./<span class="mxinfo" id="T41:U405">abs(<span class="var type1" id="S25T38U507">H_plane</span>)</span></span>)'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,79" id="srcline79"> 79</a></span><span class="line">                <span class="mxinfo" id="T39:U407"><span class="var type1" id="S28T39U510">U1</span> = <span class="mxinfo" id="T39:U409"><span class="var type1" id="S27T31U512">AmpU1</span> * <span class="mxinfo" id="T39:U411">exp(<span class="mxinfo" id="T39:U412">1i*<span class="var type1" id="S26T40U517">AngU1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,80" id="srcline80"> 80</a></span><span class="line">                <span class="mxinfo" id="T39:U414"><span class="var type1" id="S29T39U520">U2</span> = <span class="mxinfo" id="T39:U416">-<span class="var type1" id="S28T39U522">U1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,81" id="srcline81"> 81</a></span><span class="line">                <span class="mxinfo" id="T42:U418"><span class="var type1" id="S30T42U525">U11</span> = <span class="mxinfo" id="T42:U420"><span class="var type1" id="S28T39U527">U1</span>(<span class="mxinfo" id="T83:U422"><span class="mxinfo" id="T1:U423">1</span>:<span class="mxinfo" id="T1:U424">5</span></span>)</span></span>; <span class="mxinfo" id="T43:U425"><span class="var type1" id="S31T43U533">U12</span> = <span class="mxinfo" id="T43:U427"><span class="var type1" id="S28T39U535">U1</span>(<span class="mxinfo" id="T84:U429"><span class="mxinfo" id="T1:U430">6</span>:<span class="mxinfo" id="T1:U431">11</span></span>)</span></span>; <span class="mxinfo" id="T44:U432"><span class="var type1" id="S32T44U541">U13</span> = <span class="mxinfo" id="T44:U434"><span class="var type1" id="S28T39U543">U1</span>(<span class="mxinfo" id="T85:U436"><span class="mxinfo" id="T1:U437">12</span>:<span class="mxinfo" id="T1:U438">19</span></span>)</span></span>; <span class="mxinfo" id="T45:U439"><span class="var type1" id="S33T45U549">U14</span> = <span class="mxinfo" id="T45:U441"><span class="var type1" id="S28T39U551">U1</span>(<span class="mxinfo" id="T86:U443"><span class="mxinfo" id="T1:U444">20</span>:<span class="mxinfo" id="T1:U445">28</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,82" id="srcline82"> 82</a></span><span class="line">                <span class="mxinfo" id="T42:U446"><span class="var type1" id="S34T42U557">U21</span> = <span class="mxinfo" id="T42:U448">flipud(<span class="mxinfo" id="T42:U449"><span class="var type1" id="S29T39U561">U2</span>(<span class="mxinfo" id="T83:U451"><span class="mxinfo" id="T1:U452">1</span>:<span class="mxinfo" id="T1:U453">5</span></span>)</span>)</span></span>; <span class="mxinfo" id="T43:U454"><span class="var type1" id="S35T43U567">U22</span> = <span class="mxinfo" id="T43:U456">flipud(<span class="mxinfo" id="T43:U457"><span class="var type1" id="S29T39U571">U2</span>(<span class="mxinfo" id="T84:U459"><span class="mxinfo" id="T1:U460">6</span>:<span class="mxinfo" id="T1:U461">11</span></span>)</span>)</span></span>; <span class="mxinfo" id="T44:U462"><span class="var type1" id="S36T44U577">U23</span> = <span class="mxinfo" id="T44:U464">flipud(<span class="mxinfo" id="T44:U465"><span class="var type1" id="S29T39U581">U2</span>(<span class="mxinfo" id="T85:U467"><span class="mxinfo" id="T1:U468">12</span>:<span class="mxinfo" id="T1:U469">19</span></span>)</span>)</span></span>; <span class="mxinfo" id="T45:U470"><span class="var type1" id="S37T45U587">U24</span> = <span class="mxinfo" id="T45:U472">flipud(<span class="mxinfo" id="T45:U473"><span class="var type1" id="S29T39U591">U2</span>(<span class="mxinfo" id="T86:U475"><span class="mxinfo" id="T1:U476">20</span>:<span class="mxinfo" id="T1:U477">28</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,83" id="srcline83"> 83</a></span><span class="line">                <span class="mxinfo" id="T42:U478"><span class="var type1" id="S50T42U597">U31</span> = <span class="var type1" id="S30T42U598">U11</span></span>; <span class="mxinfo" id="T43:U481"><span class="var type1" id="S51T43U601">U32</span> = <span class="var type1" id="S31T43U602">U12</span></span>; <span class="mxinfo" id="T44:U484"><span class="var type1" id="S52T44U605">U33</span> = <span class="var type1" id="S32T44U606">U13</span></span>; <span class="mxinfo" id="T45:U487"><span class="var type1" id="S53T45U609">U34</span> = <span class="var type1" id="S33T45U610">U14</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,84" id="srcline84"> 84</a></span><span class="line">                <span class="mxinfo" id="T42:U490"><span class="var type1" id="S54T42U613">U41</span> = <span class="var type1" id="S34T42U614">U21</span></span>; <span class="mxinfo" id="T43:U493"><span class="var type1" id="S55T43U617">U42</span> = <span class="var type1" id="S35T43U618">U22</span></span>; <span class="mxinfo" id="T44:U496"><span class="var type1" id="S56T44U621">U43</span> = <span class="var type1" id="S36T44U622">U23</span></span>; <span class="mxinfo" id="T45:U499"><span class="var type1" id="S57T45U625">U44</span> = <span class="var type1" id="S37T45U626">U24</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,85" id="srcline85"> 85</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="78,86" id="srcline86"> 86</a></span><span class="line">                <span class="mxinfo" id="T46:U502"><span class="var type1" id="S2T46U629">U</span> = <span class="mxinfo" id="T46:U504">[<span class="var type1" id="S30T42U632">U11</span>;<span class="var type1" id="S34T42U634">U21</span>;<span class="var type1" id="S50T42U636">U31</span>;<span class="var type1" id="S54T42U638">U41</span>;<span class="var type1" id="S31T43U640">U12</span>;<span class="var type1" id="S35T43U642">U22</span>;<span class="var type1" id="S51T43U644">U32</span>;<span class="var type1" id="S55T43U646">U42</span>;<span class="var type1" id="S32T44U648">U13</span>;<span class="var type1" id="S36T44U650">U23</span>;<span class="var type1" id="S52T44U652">U33</span>;<span class="var type1" id="S56T44U654">U43</span>;<span class="var type1" id="S33T45U656">U14</span>;<span class="var type1" id="S37T45U658">U24</span>;<span class="var type1" id="S53T45U660">U34</span>;<span class="var type1" id="S57T45U662">U44</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,87" id="srcline87"> 87</a></span><span class="line">                <span class="mxinfo" id="T47:U521"><span class="var type1" id="S12T47U665">AmpU</span> = <span class="mxinfo" id="T47:U523">abs(<span class="var type1" id="S2T46U668">U</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,88" id="srcline88"> 88</a></span><span class="line">                <span class="mxinfo" id="T47:U525"><span class="var type1" id="S10T47U671">AngU</span> = <span class="mxinfo" id="T47:U527">angle(<span class="var type1" id="S2T46U674">U</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,89" id="srcline89"> 89</a></span><span class="line">    <span class="keyword">otherwise</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,90" id="srcline90"> 90</a></span><span class="line">        <span class="mxinfo" id="T46:U529"><span class="var type1" id="S2T46U678">U</span> = <span class="mxinfo" id="T47:U531">zeros(<span class="mxinfo" id="T1:U532">112</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,91" id="srcline91"> 91</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="78,92" id="srcline92"> 92</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,93" id="srcline93"> 93</a></span><span class="line"><span class="comment">%求近场增益G</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,94" id="srcline94"> 94</a></span><span class="line"><span class="comment">% G = P' * P / ( U' * U );</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,95" id="srcline95"> 95</a></span><span class="line"><span class="comment">% save gain G;</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,96" id="srcline96"> 96</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,97" id="srcline97"> 97</a></span><span class="line"><span class="comment">% xlswrite('amp.xls',AmpU);</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,98" id="srcline98"> 98</a></span><span class="line"><span class="comment">% xlswrite('angle.xls',AngU);</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,99" id="srcline99"> 99</a></span><span class="line"><span class="mxinfo" id="T47:U533"><span class="var type1" id="S10T47U685">AngU</span> = <span class="mxinfo" id="T47:U535">angle(<span class="var type1" id="S2T46U688">U</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,100" id="srcline100">100</a></span><span class="line"><span class="mxinfo" id="T47:U537"><span class="var type1" id="S59T47U691">AngleD</span> = <span class="mxinfo" id="T47:U539"><span class="mxinfo" id="T47:U540"><span class="var type1" id="S10T47U694">AngU</span> * 180</span> / <span class="mxinfo" id="T1:U542">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,101" id="srcline101">101</a></span><span class="line"><span class="mxinfo" id="T47:U543"><span class="var type1" id="S3T47U700">AngleT</span> = <span class="mxinfo" id="T47:U545">round(<span class="mxinfo" id="T47:U546">(<span class="mxinfo" id="T47:U547"><span class="var type1" id="S59T47U706">AngleD</span> + <span class="mxinfo" id="T1:U549">180</span></span>) / <span class="mxinfo" id="T1:U550">1.40625</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,102" id="srcline102">102</a></span><span class="line"><span class="comment">% xlswrite('AngleD.xls',AngleD);</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,103" id="srcline103">103</a></span><span class="line"><span class="comment">% dlmwrite('AngleT.txt','precision','%.0f','newline', 'pc');</span></span></span>
</pre>
